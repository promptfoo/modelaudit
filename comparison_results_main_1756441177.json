{
  "branch": "main",
  "timestamp": 1756441168.3686242,
  "legitimate_models": {
    "legitimate_model.pkl": {
      "exit_code": 0,
      "stdout": "Results written to results_main_legitimate_model.pkl.json\n",
      "stderr": "",
      "scan_results": {
        "bytes_scanned": 188,
        "issues": [],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl"
            },
            "timestamp": 1756441169.309611
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl"
            },
            "timestamp": 1756441169.309651
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {},
            "timestamp": 1756441169.309758
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "md5": "ccc44fda0e75cd6bbabc75c0ee01f92a",
              "sha256": "06297d262bc9f09370af925342b1ccfbb072479b1225af0ed3c9201dc66adc7a",
              "sha512": "4b8117a737ba40f104cb1761a0d53389fd757f3a2f7036a1d50d4d3319f13f152f599091ad0c0842d098fe42486ac0cf4aa5a26afaf833b474e55b131e63a5b1",
              "file_size": 188
            },
            "timestamp": 1756441169.30984
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441169.3108401
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {},
            "timestamp": 1756441169.3173509
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441169.320946
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441169.320968
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441169.3209732
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (51) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "opcode_count": 51,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441169.321171
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (3) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "max_depth_reached": 3,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.135
            },
            "timestamp": 1756441169.321214
          },
          {
            "name": "STACK_GLOBAL Module Check",
            "status": "passed",
            "message": "Safe module reference validated: collections.OrderedDict",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl (pos 39)",
            "details": {
              "module": "collections",
              "function": "OrderedDict",
              "position": 39,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.135
            },
            "timestamp": 1756441169.321474
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "opcode_count": 51,
              "ml_context_confidence": 0.135
            },
            "timestamp": 1756441169.321488
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "details": {
              "opcode_count": 51,
              "ml_context_confidence": 0.135
            },
            "timestamp": 1756441169.321501
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl",
            "type": "pickle",
            "size": 188
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/legitimate_model.pkl": {
            "file_size": 188,
            "file_hashes": {
              "md5": "ccc44fda0e75cd6bbabc75c0ee01f92a",
              "sha256": "06297d262bc9f09370af925342b1ccfbb072479b1225af0ed3c9201dc66adc7a",
              "sha512": "4b8117a737ba40f104cb1761a0d53389fd757f3a2f7036a1d50d4d3319f13f152f599091ad0c0842d098fe42486ac0cf4aa5a26afaf833b474e55b131e63a5b1"
            },
            "max_stack_depth": 3,
            "opcode_count": 51,
            "suspicious_count": 0,
            "ml_context": {
              "frameworks": {
                "pytorch": {
                  "confidence": 0.135,
                  "indicators": [],
                  "file_patterns": []
                }
              },
              "overall_confidence": 0.135,
              "is_ml_content": true,
              "detected_patterns": ["module:collections(1)"],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [
              "/Users/mdangelo/projects/modelaudit/LICENSE"
            ],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441169.334463
          }
        },
        "start_time": 1756441168.701566,
        "duration": 0.7111260890960693,
        "total_checks": 14,
        "passed_checks": 14,
        "failed_checks": 0,
        "success": true
      },
      "scan_time": 1.1241238117218018,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 0,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/samples/pickles/safe_model_with_binary.pkl": {
      "exit_code": 0,
      "stdout": "Results written to results_main_safe_model_with_binary.pkl.json\n",
      "stderr": "",
      "scan_results": {
        "bytes_scanned": 1969,
        "issues": [],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl"
            },
            "timestamp": 1756441169.99583
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl"
            },
            "timestamp": 1756441169.9958541
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {},
            "timestamp": 1756441169.995927
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "md5": "3a5484192acef2173940e2643c6f132a",
              "sha256": "f269c9cbf0755eabc20e2719915dbef69f9c47c5067072e0d71d45ca21f99254",
              "sha512": "4a49550264e585337ad3c8d582a3f6261fbe0a07dd5de46bd16219deddb58f96a58d0ae465de994ea4c5069bcc3f84e15ee4ca22db4b7fa9dc07ffbe50e9b7da",
              "file_size": 1969
            },
            "timestamp": 1756441169.996005
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441169.997751
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {},
            "timestamp": 1756441170.006631
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441170.009778
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441170.009793
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441170.009799
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (60) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "opcode_count": 60,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441170.01003
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (3) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "max_depth_reached": 3,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441170.010068
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "opcode_count": 60,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441170.010433
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "details": {
              "opcode_count": 60,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441170.010447
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl",
            "type": "pickle",
            "size": 1969
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_model_with_binary.pkl": {
            "file_size": 1969,
            "file_hashes": {
              "md5": "3a5484192acef2173940e2643c6f132a",
              "sha256": "f269c9cbf0755eabc20e2719915dbef69f9c47c5067072e0d71d45ca21f99254",
              "sha512": "4a49550264e585337ad3c8d582a3f6261fbe0a07dd5de46bd16219deddb58f96a58d0ae465de994ea4c5069bcc3f84e15ee4ca22db4b7fa9dc07ffbe50e9b7da"
            },
            "max_stack_depth": 3,
            "opcode_count": 60,
            "suspicious_count": 0,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441170.022676
          }
        },
        "start_time": 1756441169.670174,
        "duration": 0.3554801940917969,
        "total_checks": 13,
        "passed_checks": 13,
        "failed_checks": 0,
        "success": true
      },
      "scan_time": 0.6140809059143066,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 0,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/samples/pickles/safe_data.pkl": {
      "exit_code": 0,
      "stdout": "Results written to results_main_safe_data.pkl.json\n",
      "stderr": "",
      "scan_results": {
        "bytes_scanned": 41,
        "issues": [],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl"
            },
            "timestamp": 1756441170.620103
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl"
            },
            "timestamp": 1756441170.6201222
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {},
            "timestamp": 1756441170.6201842
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "md5": "c91cb5dc203194e0a3156af6f7332478",
              "sha256": "7f504b57096ec22aff19789887c8c49229d55db500ffa8805d677735b2249f32",
              "sha512": "b3363c23b5609cdce050b67578dab503c34c5c198ed30677fbe0d6a1874430799816b25426602a477bc576a658519369d07f40cad15d6fe489dba1a54a3ecb5b",
              "file_size": 41
            },
            "timestamp": 1756441170.620251
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441170.6211
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {},
            "timestamp": 1756441170.627025
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441170.629811
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441170.6298182
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441170.629822
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (19) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "opcode_count": 19,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441170.629923
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (2) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "max_depth_reached": 2,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441170.629946
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "opcode_count": 19,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441170.630135
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "details": {
              "opcode_count": 19,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441170.630144
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl",
            "type": "pickle",
            "size": 41
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_data.pkl": {
            "file_size": 41,
            "file_hashes": {
              "md5": "c91cb5dc203194e0a3156af6f7332478",
              "sha256": "7f504b57096ec22aff19789887c8c49229d55db500ffa8805d677735b2249f32",
              "sha512": "b3363c23b5609cdce050b67578dab503c34c5c198ed30677fbe0d6a1874430799816b25426602a477bc576a658519369d07f40cad15d6fe489dba1a54a3ecb5b"
            },
            "max_stack_depth": 2,
            "opcode_count": 19,
            "suspicious_count": 0,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441170.64165
          }
        },
        "start_time": 1756441170.2850492,
        "duration": 0.3586118221282959,
        "total_checks": 13,
        "passed_checks": 13,
        "failed_checks": 0,
        "success": true
      },
      "scan_time": 0.6069650650024414,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 0,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/samples/pickles/safe_large_model.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_safe_large_model.pkl.json\n",
      "stderr": "",
      "scan_results": {
        "bytes_scanned": 562936,
        "issues": [
          {
            "message": "Datasets with unspecified licenses detected (1 files). Verify data usage rights.",
            "severity": "warning",
            "location": "",
            "details": {
              "files": [
                "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl"
              ],
              "total_count": 1,
              "impact": "May restrict commercial use or redistribution"
            },
            "timestamp": 1756441171.974824,
            "type": "license_warning"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl"
            },
            "timestamp": 1756441171.21321
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl"
            },
            "timestamp": 1756441171.213231
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {},
            "timestamp": 1756441171.2132978
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "md5": "1e3517ce2d9e2fc364e9563af4a1119f",
              "sha256": "b1d9b682063cc4cb3081ceba06aa981242766792f8b937b121af0eb54bd20734",
              "sha512": "5d116d8f94e53250b8d97bf40307a60bfe4e84f37210a81c91966b746e2060bb61a0189451709edf6021d82b9dccca73a2d3ca347e633c7844a851467d66d233",
              "file_size": 562936
            },
            "timestamp": 1756441171.21572
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441171.219705
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {},
            "timestamp": 1756441171.5605419
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441171.6684558
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441171.66847
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441171.668475
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (63381) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "opcode_count": 63381,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441171.828192
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (3) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "max_depth_reached": 3,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441171.840118
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "opcode_count": 63381,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441171.858826
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "details": {
              "opcode_count": 63381,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441171.864245
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl",
            "type": "pickle",
            "size": 562936
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/safe_large_model.pkl": {
            "file_size": 562936,
            "file_hashes": {
              "md5": "1e3517ce2d9e2fc364e9563af4a1119f",
              "sha256": "b1d9b682063cc4cb3081ceba06aa981242766792f8b937b121af0eb54bd20734",
              "sha512": "5d116d8f94e53250b8d97bf40307a60bfe4e84f37210a81c91966b746e2060bb61a0189451709edf6021d82b9dccca73a2d3ca347e633c7844a851467d66d233"
            },
            "max_stack_depth": 3,
            "opcode_count": 63381,
            "suspicious_count": 0,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441171.887897
          }
        },
        "start_time": 1756441170.885956,
        "duration": 1.0890820026397705,
        "total_checks": 13,
        "passed_checks": 13,
        "failed_checks": 0,
        "success": true
      },
      "scan_time": 1.33607816696167,
      "status": "success",
      "false_positive": true,
      "false_negative": false,
      "issue_count": 1,
      "critical_issues": 0,
      "warning_issues": 0
    }
  },
  "malicious_models": {
    "simple_malicious.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_simple_malicious.pkl.json\n",
      "stderr": "2025-08-29 00:19:32,578 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/simple_malicious.pkl): Suspicious reference posix.system\n2025-08-29 00:19:32,579 - modelaudit.scanners - WARNING - [WARNING] (/Users/mdangelo/projects/modelaudit/simple_malicious.pkl (pos 69)): Found REDUCE opcode - potential __reduce__ method execution\n2025-08-29 00:19:32,579 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/simple_malicious.pkl (pos 28)): Suspicious module reference found: posix.system\n",
      "scan_results": {
        "bytes_scanned": 72,
        "issues": [
          {
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441172.578198,
            "type": "pickle_check"
          },
          {
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl (pos 69)",
            "details": {
              "position": 69,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441172.579487,
            "type": "pickle_check"
          },
          {
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441172.579566,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl"
            },
            "timestamp": 1756441172.5686002
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl"
            },
            "timestamp": 1756441172.5686169
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {},
            "timestamp": 1756441172.568672
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "md5": "963f83a786058f902e67014ec07fb8f6",
              "sha256": "89b2f71e5320e70c87be1374d547bc56057e50ac69a4d89767a1b808e3e01aae",
              "sha512": "433b51c4cbd22b64d5c5a6ca0e2b3ac80bd1b9d19821e818b5913127a98f113bfe8690d3385e259f22ffad1b13cf6f55ab3876076cd696bcd31413ce35f0e400",
              "file_size": 72
            },
            "timestamp": 1756441172.5687392
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441172.569619
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {},
            "timestamp": 1756441172.575536
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441172.577987
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441172.5779939
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441172.5779982
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (15) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "opcode_count": 15,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441172.578091
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (0) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "max_depth_reached": 0,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441172.578163
          },
          {
            "name": "Advanced Global Reference Check",
            "status": "failed",
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441172.578191
          },
          {
            "name": "REDUCE Opcode Safety Check",
            "status": "failed",
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl (pos 69)",
            "details": {
              "position": 69,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441172.5794811
          },
          {
            "name": "STACK_GLOBAL Module Check",
            "status": "failed",
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441172.579563
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441172.579595
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441172.579605
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl",
            "type": "pickle",
            "size": 72
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/simple_malicious.pkl": {
            "file_size": 72,
            "file_hashes": {
              "md5": "963f83a786058f902e67014ec07fb8f6",
              "sha256": "89b2f71e5320e70c87be1374d547bc56057e50ac69a4d89767a1b808e3e01aae",
              "sha512": "433b51c4cbd22b64d5c5a6ca0e2b3ac80bd1b9d19821e818b5913127a98f113bfe8690d3385e259f22ffad1b13cf6f55ab3876076cd696bcd31413ce35f0e400"
            },
            "max_stack_depth": 0,
            "opcode_count": 15,
            "suspicious_count": 2,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [
              "/Users/mdangelo/projects/modelaudit/LICENSE"
            ],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441172.592122
          }
        },
        "start_time": 1756441172.2293131,
        "duration": 0.3796098232269287,
        "total_checks": 16,
        "passed_checks": 13,
        "failed_checks": 3,
        "success": true
      },
      "scan_time": 0.6371510028839111,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 3,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "malicious_chained.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_malicious_chained.pkl.json\n",
      "stderr": "2025-08-29 00:19:33,194 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/malicious_chained.pkl): Suspicious reference subprocess.call\n2025-08-29 00:19:33,194 - modelaudit.scanners - WARNING - [WARNING] (/Users/mdangelo/projects/modelaudit/malicious_chained.pkl (pos 63)): Found REDUCE opcode - potential __reduce__ method execution\n2025-08-29 00:19:33,194 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/malicious_chained.pkl (pos 31)): Suspicious module reference found: subprocess.call\n",
      "scan_results": {
        "bytes_scanned": 66,
        "issues": [
          {
            "message": "Suspicious reference subprocess.call",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "module": "subprocess",
              "function": "call",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'subprocess' module allows spawning new processes and executing system commands. This is a critical security risk as it enables arbitrary command execution on the host system.",
            "timestamp": 1756441173.1940281,
            "type": "pickle_check"
          },
          {
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl (pos 63)",
            "details": {
              "position": 63,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441173.1946251,
            "type": "pickle_check"
          },
          {
            "message": "Suspicious module reference found: subprocess.call",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl (pos 31)",
            "details": {
              "module": "subprocess",
              "function": "call",
              "position": 31,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'subprocess' module allows spawning new processes and executing system commands. This is a critical security risk as it enables arbitrary command execution on the host system.",
            "timestamp": 1756441173.194668,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl"
            },
            "timestamp": 1756441173.183342
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl"
            },
            "timestamp": 1756441173.183367
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {},
            "timestamp": 1756441173.183444
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "md5": "7a35c7484327baf0051ac34dc4108ee1",
              "sha256": "34ae08b52d02296c95b20ecfe578173b529a76c3ada739e2ecc4c25cbe2d4c19",
              "sha512": "27af7ca6e2fa9693379cfc65be0f69ea41aae052037b6573761df70bf91e5071f47ee5f04ef7b6297a468844c50c24d8f24210eea87c17ae9c5fac95e67c0d4c",
              "file_size": 66
            },
            "timestamp": 1756441173.183522
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441173.184464
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {},
            "timestamp": 1756441173.190906
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441173.1938639
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441173.193873
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441173.193877
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (21) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "opcode_count": 21,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441173.193985
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (1) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "max_depth_reached": 1,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441173.194012
          },
          {
            "name": "Advanced Global Reference Check",
            "status": "failed",
            "message": "Suspicious reference subprocess.call",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "module": "subprocess",
              "function": "call",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'subprocess' module allows spawning new processes and executing system commands. This is a critical security risk as it enables arbitrary command execution on the host system.",
            "timestamp": 1756441173.194023
          },
          {
            "name": "REDUCE Opcode Safety Check",
            "status": "failed",
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl (pos 63)",
            "details": {
              "position": 63,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441173.194622
          },
          {
            "name": "STACK_GLOBAL Module Check",
            "status": "failed",
            "message": "Suspicious module reference found: subprocess.call",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl (pos 31)",
            "details": {
              "module": "subprocess",
              "function": "call",
              "position": 31,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'subprocess' module allows spawning new processes and executing system commands. This is a critical security risk as it enables arbitrary command execution on the host system.",
            "timestamp": 1756441173.194665
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "opcode_count": 21,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441173.194695
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "details": {
              "opcode_count": 21,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441173.194705
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl",
            "type": "pickle",
            "size": 66
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/malicious_chained.pkl": {
            "file_size": 66,
            "file_hashes": {
              "md5": "7a35c7484327baf0051ac34dc4108ee1",
              "sha256": "34ae08b52d02296c95b20ecfe578173b529a76c3ada739e2ecc4c25cbe2d4c19",
              "sha512": "27af7ca6e2fa9693379cfc65be0f69ea41aae052037b6573761df70bf91e5071f47ee5f04ef7b6297a468844c50c24d8f24210eea87c17ae9c5fac95e67c0d4c"
            },
            "max_stack_depth": 1,
            "opcode_count": 21,
            "suspicious_count": 2,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [
              "/Users/mdangelo/projects/modelaudit/LICENSE"
            ],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441173.206723
          }
        },
        "start_time": 1756441172.8628428,
        "duration": 0.3621213436126709,
        "total_checks": 16,
        "passed_checks": 13,
        "failed_checks": 3,
        "success": true
      },
      "scan_time": 0.6218948364257812,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 3,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "malicious_obfuscated.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_malicious_obfuscated.pkl.json\n",
      "stderr": "2025-08-29 00:19:33,821 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl): Suspicious reference posix.system\n2025-08-29 00:19:33,822 - modelaudit.scanners - WARNING - [WARNING] (/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl (pos 80)): Found REDUCE opcode - potential __reduce__ method execution\n2025-08-29 00:19:33,822 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl (pos 28)): Suspicious module reference found: posix.system\n",
      "scan_results": {
        "bytes_scanned": 83,
        "issues": [
          {
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441173.821583,
            "type": "pickle_check"
          },
          {
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl (pos 80)",
            "details": {
              "position": 80,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441173.822443,
            "type": "pickle_check"
          },
          {
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441173.8225129,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl"
            },
            "timestamp": 1756441173.812176
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl"
            },
            "timestamp": 1756441173.8121972
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {},
            "timestamp": 1756441173.812258
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "md5": "0443dd1183e25949c643618f1a55aca5",
              "sha256": "d7f6531600797669820ebf594237eb21a7f76becf62498b601c992f4fdc9ae76",
              "sha512": "55cdb80aeab09292fd518d84821baca4f87ecf6b32347bbade48a460d184cd906ee73495008a4acca6e22a50b53e2686582a540c55c3c53e79fc7de184c49026",
              "file_size": 83
            },
            "timestamp": 1756441173.812331
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441173.8132648
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {},
            "timestamp": 1756441173.819105
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441173.8214421
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441173.8214478
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441173.821451
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (15) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "opcode_count": 15,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441173.821543
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (0) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "max_depth_reached": 0,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441173.821567
          },
          {
            "name": "Advanced Global Reference Check",
            "status": "failed",
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441173.821579
          },
          {
            "name": "REDUCE Opcode Safety Check",
            "status": "failed",
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl (pos 80)",
            "details": {
              "position": 80,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441173.822438
          },
          {
            "name": "STACK_GLOBAL Module Check",
            "status": "failed",
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441173.82251
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441173.8225431
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441173.8225532
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl",
            "type": "pickle",
            "size": 83
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/malicious_obfuscated.pkl": {
            "file_size": 83,
            "file_hashes": {
              "md5": "0443dd1183e25949c643618f1a55aca5",
              "sha256": "d7f6531600797669820ebf594237eb21a7f76becf62498b601c992f4fdc9ae76",
              "sha512": "55cdb80aeab09292fd518d84821baca4f87ecf6b32347bbade48a460d184cd906ee73495008a4acca6e22a50b53e2686582a540c55c3c53e79fc7de184c49026"
            },
            "max_stack_depth": 0,
            "opcode_count": 15,
            "suspicious_count": 2,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [
              "/Users/mdangelo/projects/modelaudit/LICENSE"
            ],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441173.835507
          }
        },
        "start_time": 1756441173.481002,
        "duration": 0.372006893157959,
        "total_checks": 16,
        "passed_checks": 13,
        "failed_checks": 3,
        "success": true
      },
      "scan_time": 0.6288061141967773,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 3,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/pickles/stack_global_attack.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_stack_global_attack.pkl.json\n",
      "stderr": "2025-08-29 00:19:34,465 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl): Suspicious reference posix.system\n2025-08-29 00:19:34,466 - modelaudit.scanners - WARNING - [WARNING] (/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl (pos 57)): Found REDUCE opcode - potential __reduce__ method execution\n2025-08-29 00:19:34,466 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl (pos 28)): Suspicious module reference found: posix.system\n",
      "scan_results": {
        "bytes_scanned": 60,
        "issues": [
          {
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441174.465572,
            "type": "pickle_check"
          },
          {
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl (pos 57)",
            "details": {
              "position": 57,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441174.466235,
            "type": "pickle_check"
          },
          {
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441174.4662778,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl"
            },
            "timestamp": 1756441174.455334
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl"
            },
            "timestamp": 1756441174.455358
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {},
            "timestamp": 1756441174.455435
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "md5": "6d6f30c882e25210eefad589e49896e5",
              "sha256": "3ca41fdb5a447d23fba9ec7621321665e518e30690458b897b72fa09ba6ee085",
              "sha512": "12be28bd95770100799302014dc17a3ecfe34dfd6ea750a028a0fc1bd9e1cd0c2c3f508b215ba6ec69bb65f0cecb36f4e5b9400893d5a28610c2622b46bed916",
              "file_size": 60
            },
            "timestamp": 1756441174.455512
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441174.456447
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {},
            "timestamp": 1756441174.4628851
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441174.4654238
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441174.465431
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 5",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "protocol_version": 5
            },
            "timestamp": 1756441174.465434
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (15) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "opcode_count": 15,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441174.465527
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (0) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "max_depth_reached": 0,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441174.465555
          },
          {
            "name": "Advanced Global Reference Check",
            "status": "failed",
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441174.465566
          },
          {
            "name": "REDUCE Opcode Safety Check",
            "status": "failed",
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl (pos 57)",
            "details": {
              "position": 57,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441174.466233
          },
          {
            "name": "STACK_GLOBAL Module Check",
            "status": "failed",
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441174.4662762
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441174.466304
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441174.466313
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl",
            "type": "pickle",
            "size": 60
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/stack_global_attack.pkl": {
            "file_size": 60,
            "file_hashes": {
              "md5": "6d6f30c882e25210eefad589e49896e5",
              "sha256": "3ca41fdb5a447d23fba9ec7621321665e518e30690458b897b72fa09ba6ee085",
              "sha512": "12be28bd95770100799302014dc17a3ecfe34dfd6ea750a028a0fc1bd9e1cd0c2c3f508b215ba6ec69bb65f0cecb36f4e5b9400893d5a28610c2622b46bed916"
            },
            "max_stack_depth": 0,
            "opcode_count": 15,
            "suspicious_count": 2,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441174.479043
          }
        },
        "start_time": 1756441174.1187682,
        "duration": 0.3623647689819336,
        "total_checks": 16,
        "passed_checks": 13,
        "failed_checks": 3,
        "success": true
      },
      "scan_time": 0.6210901737213135,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 3,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/pickles/multiple_stream_attack.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_multiple_stream_attack.pkl.json\n",
      "stderr": "2025-08-29 00:19:35,070 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl): Suspicious reference builtins.eval\n",
      "scan_results": {
        "bytes_scanned": 38,
        "issues": [
          {
            "message": "Suspicious reference builtins.eval",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "module": "builtins",
              "function": "eval",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "Direct access to builtin functions can be used to bypass restrictions or access dangerous functionality like eval/exec.",
            "timestamp": 1756441175.070237,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl"
            },
            "timestamp": 1756441175.060637
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl"
            },
            "timestamp": 1756441175.060658
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {},
            "timestamp": 1756441175.0607328
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "md5": "9885dc2b6c7c239428d62f370761d510",
              "sha256": "963c8a21b1b7a6f82adbd59ca54c353505f95f62f9bf2f822b60504ecff74a33",
              "sha512": "e26f3c137e1857870d916580da9d39fcccd6b1749422f6db24fc2f6b47ac0d0e9b8a7d7df8f9ba58a4b42fb72ccc458962ed9758f3935a1578ae653b7930013a",
              "file_size": 100
            },
            "timestamp": 1756441175.0608032
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441175.0617568
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {},
            "timestamp": 1756441175.067754
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441175.070119
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441175.070125
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441175.070129
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (10) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "opcode_count": 10,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441175.0702028
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (0) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "max_depth_reached": 0,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441175.0702238
          },
          {
            "name": "Advanced Global Reference Check",
            "status": "failed",
            "message": "Suspicious reference builtins.eval",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "module": "builtins",
              "function": "eval",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "Direct access to builtin functions can be used to bypass restrictions or access dangerous functionality like eval/exec.",
            "timestamp": 1756441175.0702322
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "opcode_count": 10,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441175.070496
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "details": {
              "opcode_count": 10,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441175.070504
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl",
            "type": "pickle",
            "size": 100
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/pickles/multiple_stream_attack.pkl": {
            "file_size": 100,
            "file_hashes": {
              "md5": "9885dc2b6c7c239428d62f370761d510",
              "sha256": "963c8a21b1b7a6f82adbd59ca54c353505f95f62f9bf2f822b60504ecff74a33",
              "sha512": "e26f3c137e1857870d916580da9d39fcccd6b1749422f6db24fc2f6b47ac0d0e9b8a7d7df8f9ba58a4b42fb72ccc458962ed9758f3935a1578ae653b7930013a"
            },
            "max_stack_depth": 0,
            "opcode_count": 10,
            "suspicious_count": 1,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441175.082391
          }
        },
        "start_time": 1756441174.7446778,
        "duration": 0.33947229385375977,
        "total_checks": 14,
        "passed_checks": 13,
        "failed_checks": 1,
        "success": true
      },
      "scan_time": 0.6115889549255371,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 1,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/samples/pickles/malicious_system_call.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_malicious_system_call.pkl.json\n",
      "stderr": "2025-08-29 00:19:35,688 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl): Suspicious reference posix.system\n2025-08-29 00:19:35,688 - modelaudit.scanners - WARNING - [WARNING] (/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl (pos 79)): Found REDUCE opcode - potential __reduce__ method execution\n2025-08-29 00:19:35,688 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl (pos 28)): Suspicious module reference found: posix.system\n",
      "scan_results": {
        "bytes_scanned": 82,
        "issues": [
          {
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441175.6879911,
            "type": "pickle_check"
          },
          {
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl (pos 79)",
            "details": {
              "position": 79,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441175.688879,
            "type": "pickle_check"
          },
          {
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441175.6889548,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl"
            },
            "timestamp": 1756441175.678429
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl"
            },
            "timestamp": 1756441175.678456
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {},
            "timestamp": 1756441175.6785321
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "md5": "7866977b6b51d7fa3e6602e7238b13cf",
              "sha256": "f98e96e2a0e16ca139b0a7250f7bdae4d2340fa1386ee6bfd667ab2784b2e51e",
              "sha512": "498ad126ed53104c568aff5c68b497b5676432ad9cc1b48890c0d945f6a8efcfdc409acfe345e4a9ba7eaca05189846c68fa692eab8f515fa56e5f5670e02e16",
              "file_size": 82
            },
            "timestamp": 1756441175.678623
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441175.679601
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {},
            "timestamp": 1756441175.68545
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441175.687762
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441175.687768
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441175.6877708
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (15) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "opcode_count": 15,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441175.6879308
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (0) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "max_depth_reached": 0,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441175.687971
          },
          {
            "name": "Advanced Global Reference Check",
            "status": "failed",
            "message": "Suspicious reference posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "module": "posix",
              "function": "system",
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441175.687986
          },
          {
            "name": "REDUCE Opcode Safety Check",
            "status": "failed",
            "message": "Found REDUCE opcode - potential __reduce__ method execution",
            "severity": "warning",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl (pos 79)",
            "details": {
              "position": 79,
              "opcode": "REDUCE",
              "ml_context_confidence": 0.0,
              "entropy_classification": "unknown",
              "entropy_confidence": 0.0
            },
            "why": "The REDUCE opcode calls a callable with arguments, effectively executing arbitrary Python functions. This is the primary mechanism for pickle-based code execution attacks through __reduce__ methods.",
            "timestamp": 1756441175.688874
          },
          {
            "name": "STACK_GLOBAL Module Check",
            "status": "failed",
            "message": "Suspicious module reference found: posix.system",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl (pos 28)",
            "details": {
              "module": "posix",
              "function": "system",
              "position": 28,
              "opcode": "STACK_GLOBAL",
              "ml_context_confidence": 0.0
            },
            "why": "The 'posix' module provides direct access to POSIX system calls on Unix-like systems. Like the 'os' module, it can execute arbitrary system commands and manipulate the file system. The 'posix.system' function is equivalent to 'os.system' and poses the same security risks.",
            "timestamp": 1756441175.6889532
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441175.688989
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "details": {
              "opcode_count": 15,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441175.688999
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl",
            "type": "pickle",
            "size": 82
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_system_call.pkl": {
            "file_size": 82,
            "file_hashes": {
              "md5": "7866977b6b51d7fa3e6602e7238b13cf",
              "sha256": "f98e96e2a0e16ca139b0a7250f7bdae4d2340fa1386ee6bfd667ab2784b2e51e",
              "sha512": "498ad126ed53104c568aff5c68b497b5676432ad9cc1b48890c0d945f6a8efcfdc409acfe345e4a9ba7eaca05189846c68fa692eab8f515fa56e5f5670e02e16"
            },
            "max_stack_depth": 0,
            "opcode_count": 15,
            "suspicious_count": 2,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441175.7016041
          }
        },
        "start_time": 1756441175.354613,
        "duration": 0.3493008613586426,
        "total_checks": 16,
        "passed_checks": 13,
        "failed_checks": 3,
        "success": true
      },
      "scan_time": 0.6124248504638672,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 3,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/samples/pickles/malicious_model_realistic.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_malicious_model_realistic.pkl.json\n",
      "stderr": "2025-08-29 00:19:36,292 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl (pos 390)): Nested pickle payload detected\n2025-08-29 00:19:36,292 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl (pos 486)): Encoded pickle payload detected\n",
      "scan_results": {
        "bytes_scanned": 591,
        "issues": [
          {
            "message": "Nested pickle payload detected",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl (pos 390)",
            "details": {
              "position": 390,
              "opcode": "SHORT_BINBYTES",
              "sample_size": 74
            },
            "why": "Pickle operations within pickled data (nested pickling) is often used to create multi-stage exploits or hide malicious payloads.",
            "timestamp": 1756441176.292311,
            "type": "pickle_check"
          },
          {
            "message": "Encoded pickle payload detected",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl (pos 486)",
            "details": {
              "position": 486,
              "opcode": "SHORT_BINUNICODE",
              "encoding": "base64",
              "decoded_size": 74
            },
            "why": "Pickle operations within pickled data (nested pickling) is often used to create multi-stage exploits or hide malicious payloads.",
            "timestamp": 1756441176.292464,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl"
            },
            "timestamp": 1756441176.281358
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl"
            },
            "timestamp": 1756441176.281377
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {},
            "timestamp": 1756441176.281443
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "md5": "9263c18c3987a29c14600c7693a918f5",
              "sha256": "c285ff00c18f363103d8a4ca5fa551b68054befe11c7d28bf5c158431d301689",
              "sha512": "f8159fb1664f705c91376930efebd8f25dea8d585de1b81c5f54ff96a0b75796734af0411acf8fd2ef990007ae770895b59de15d5b8cc7351b011e0c2da6cd90",
              "file_size": 591
            },
            "timestamp": 1756441176.281518
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441176.2827342
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {},
            "timestamp": 1756441176.289171
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441176.291756
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441176.2917628
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441176.291766
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (61) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "opcode_count": 61,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441176.291965
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (2) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "max_depth_reached": 2,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441176.291998
          },
          {
            "name": "Nested Pickle Detection",
            "status": "failed",
            "message": "Nested pickle payload detected",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl (pos 390)",
            "details": {
              "position": 390,
              "opcode": "SHORT_BINBYTES",
              "sample_size": 74
            },
            "why": "Pickle operations within pickled data (nested pickling) is often used to create multi-stage exploits or hide malicious payloads.",
            "timestamp": 1756441176.2923038
          },
          {
            "name": "Encoded Pickle Detection",
            "status": "failed",
            "message": "Encoded pickle payload detected",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl (pos 486)",
            "details": {
              "position": 486,
              "opcode": "SHORT_BINUNICODE",
              "encoding": "base64",
              "decoded_size": 74
            },
            "why": "Pickle operations within pickled data (nested pickling) is often used to create multi-stage exploits or hide malicious payloads.",
            "timestamp": 1756441176.292462
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "opcode_count": 61,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441176.292504
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "details": {
              "opcode_count": 61,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441176.2925172
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl",
            "type": "pickle",
            "size": 591
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/malicious_model_realistic.pkl": {
            "file_size": 591,
            "file_hashes": {
              "md5": "9263c18c3987a29c14600c7693a918f5",
              "sha256": "c285ff00c18f363103d8a4ca5fa551b68054befe11c7d28bf5c158431d301689",
              "sha512": "f8159fb1664f705c91376930efebd8f25dea8d585de1b81c5f54ff96a0b75796734af0411acf8fd2ef990007ae770895b59de15d5b8cc7351b011e0c2da6cd90"
            },
            "max_stack_depth": 2,
            "opcode_count": 61,
            "suspicious_count": 0,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441176.304596
          }
        },
        "start_time": 1756441175.95928,
        "duration": 0.34751200675964355,
        "total_checks": 15,
        "passed_checks": 13,
        "failed_checks": 2,
        "success": true
      },
      "scan_time": 0.6072287559509277,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 2,
      "critical_issues": 0,
      "warning_issues": 0
    },
    "tests/assets/samples/pickles/nested_pickle_base64.pkl": {
      "exit_code": 1,
      "stdout": "Results written to results_main_nested_pickle_base64.pkl.json\n",
      "stderr": "2025-08-29 00:19:36,908 - modelaudit.scanners - CRITICAL - [CRITICAL] (/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl (pos 58)): Encoded pickle payload detected\n",
      "scan_results": {
        "bytes_scanned": 256,
        "issues": [
          {
            "message": "Encoded pickle payload detected",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl (pos 58)",
            "details": {
              "position": 58,
              "opcode": "SHORT_BINUNICODE",
              "encoding": "base64",
              "decoded_size": 74
            },
            "why": "Pickle operations within pickled data (nested pickling) is often used to create multi-stage exploits or hide malicious payloads.",
            "timestamp": 1756441176.9087338,
            "type": "pickle_check"
          }
        ],
        "checks": [
          {
            "name": "Path Exists",
            "status": "passed",
            "message": "Path exists",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl"
            },
            "timestamp": 1756441176.897971
          },
          {
            "name": "Path Readable",
            "status": "passed",
            "message": "Path is readable",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl"
            },
            "timestamp": 1756441176.89799
          },
          {
            "name": "File Type Validation",
            "status": "passed",
            "message": "File type validation passed",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {},
            "timestamp": 1756441176.898054
          },
          {
            "name": "File Integrity Hash",
            "status": "passed",
            "message": "File integrity hashes calculated",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "md5": "4cf35300a8d1227aec1b5e3a7280e7e1",
              "sha256": "cc374e216559a6480b8387254be7a0ae5293ed29a424202650b94c1d54e5c617",
              "sha512": "d710bfb129bdf51b25b28abe3c4d0e2dea9bf1537ca493dade23b60a404f2f98672d75be3870743c482db6e92b18e1f58ab590139ee66eb768430fc472fc485f",
              "file_size": 256
            },
            "timestamp": 1756441176.8981178
          },
          {
            "name": "Dangerous Pattern Detection",
            "status": "passed",
            "message": "No dangerous patterns found in raw file content",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "detection_method": "raw_content_scan",
              "patterns_checked": [
                "posix",
                "subprocess",
                "eval",
                "exec",
                "__import__",
                "builtins"
              ]
            },
            "timestamp": 1756441176.89919
          },
          {
            "name": "Embedded Secrets Detection",
            "status": "passed",
            "message": "No embedded secrets detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {},
            "timestamp": 1756441176.905149
          },
          {
            "name": "JIT/Script Code Execution Summary",
            "status": "passed",
            "message": "No JIT/Script code execution risks detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441176.908194
          },
          {
            "name": "Network Communication Summary",
            "status": "passed",
            "message": "No network communication patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "aggregated": true,
              "aggregation_type": "summary"
            },
            "timestamp": 1756441176.9082072
          },
          {
            "name": "Pickle Protocol Version Check",
            "status": "passed",
            "message": "Valid pickle protocol version 4",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "protocol_version": 4
            },
            "timestamp": 1756441176.908212
          },
          {
            "name": "Opcode Count Check",
            "status": "passed",
            "message": "Opcode count (29) is within limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "opcode_count": 29,
              "max_opcodes": 1000000
            },
            "timestamp": 1756441176.908361
          },
          {
            "name": "Stack Depth Validation",
            "status": "passed",
            "message": "Maximum stack depth (2) is within safe limits",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "max_depth_reached": 2,
              "ml_adjusted_limit": 1000,
              "base_limit": 1000,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441176.908393
          },
          {
            "name": "Encoded Pickle Detection",
            "status": "failed",
            "message": "Encoded pickle payload detected",
            "severity": "critical",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl (pos 58)",
            "details": {
              "position": 58,
              "opcode": "SHORT_BINUNICODE",
              "encoding": "base64",
              "decoded_size": 74
            },
            "why": "Pickle operations within pickled data (nested pickling) is often used to create multi-stage exploits or hide malicious payloads.",
            "timestamp": 1756441176.908722
          },
          {
            "name": "Reduce Pattern Analysis",
            "status": "passed",
            "message": "No dangerous __reduce__ patterns detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "opcode_count": 29,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441176.9088929
          },
          {
            "name": "Opcode Sequence Analysis",
            "status": "passed",
            "message": "No suspicious opcode sequences detected",
            "location": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "details": {
              "opcode_count": 29,
              "ml_context_confidence": 0.0
            },
            "timestamp": 1756441176.908905
          }
        ],
        "files_scanned": 1,
        "assets": [
          {
            "path": "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl",
            "type": "pickle",
            "size": 256
          }
        ],
        "has_errors": false,
        "scanner_names": [],
        "file_metadata": {
          "/Users/mdangelo/projects/modelaudit/tests/assets/samples/pickles/nested_pickle_base64.pkl": {
            "file_size": 256,
            "file_hashes": {
              "md5": "4cf35300a8d1227aec1b5e3a7280e7e1",
              "sha256": "cc374e216559a6480b8387254be7a0ae5293ed29a424202650b94c1d54e5c617",
              "sha512": "d710bfb129bdf51b25b28abe3c4d0e2dea9bf1537ca493dade23b60a404f2f98672d75be3870743c482db6e92b18e1f58ab590139ee66eb768430fc472fc485f"
            },
            "max_stack_depth": 2,
            "opcode_count": 29,
            "suspicious_count": 0,
            "ml_context": {
              "frameworks": {},
              "overall_confidence": 0.0,
              "is_ml_content": false,
              "detected_patterns": [],
              "optimization_hints": []
            },
            "license_info": [],
            "copyright_notices": [],
            "license_files_nearby": [],
            "is_dataset": true,
            "is_model": true,
            "risk_score": 0.0,
            "scan_timestamp": 1756441176.930537
          }
        },
        "start_time": 1756441176.5664499,
        "duration": 0.36634016036987305,
        "total_checks": 14,
        "passed_checks": 13,
        "failed_checks": 1,
        "success": true
      },
      "scan_time": 0.6256709098815918,
      "status": "success",
      "false_positive": false,
      "false_negative": false,
      "issue_count": 1,
      "critical_issues": 0,
      "warning_issues": 0
    }
  },
  "summary": {
    "legitimate_models_tested": 4,
    "malicious_models_tested": 8,
    "false_positives": 1,
    "false_negatives": 0,
    "false_positive_rate": 0.25,
    "false_negative_rate": 0.0,
    "accuracy": 0.9166666666666666
  }
}
